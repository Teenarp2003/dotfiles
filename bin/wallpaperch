#!/bin/bash

# Rofi wallpaper selection script
wallpaper=$(exa ~/.config/wallpaper | while read A ; do  echo -en "$A\x00icon\x1f~/.config/wallpaper/$A\n" ; done | rofi -dmenu -theme ~/.config/rofi/wallpaper.rasi)
wallpapersel=$wallpaper
echo "$wallpapersel" > ~/.cache/wal/wal-n.txt
wallpaper_path=~/.config/wallpaper/$wallpapersel
# Set the theme using pywal
if [ -z "$wallpapersel" ]; then 
  wallpaper_path="NULL"; 
fi
wal -i "$wallpaper_path"
. "${HOME}/.cache/wal/colors.sh"
bspc config normal_border_color "$color1"
replace-wal.sh
bspc config active_border_color "$color2"
bspc config focused_border_color "$color15"
wpg -a $wallpaper_path
wpg -ns $wallpapersel
FILE="/home/teenarp2026/.cache/wal/theme.conf"
wal="$(cat ~/.cache/wal/wal)"
TEXT="Background=$wal"
sed -i "3s|.*|$TEXT|" $FILE
echo "replaced theme.conf with path"
glava-colors
. "${HOME}/.cache/wal/colors.sh"
spicetify  update
betterlockscreen -u $wallpaper_path blur
